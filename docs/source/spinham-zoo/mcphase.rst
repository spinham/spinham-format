.. _zoo_mcphase:

*******
McPhase
*******

========= ======================================================================
========= ======================================================================
Status    Verified
Links     `Web <https://mcphase.github.io/webpage/>`_
Languages C++, Fortran, Perl, Java
========= ======================================================================

Spin Hamiltonian
================ 

The spin Hamiltonian is in general:

.. math::

    \hat{\mathcal{H}}
    =
    \sum_{n=1}^{N}
    \hat{\mathcal{H}}(n)
    -
    \dfrac{1}{2}
    \sum_{n,n^{\prime},\alpha,\beta}
    \mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

The first term :math:`\hat{\mathcal{H}}(n)` denotes the Hamiltonian of a
subsystem :math:`n` (e. g. an ion, or cluster of ions). The second term
describes a bilinear interaction between different subsystems through the
operators :math:`\hat{\mathcal{I}}_{\alpha}^n`, with :math:`\alpha = 1, 2, \dots, m`.
The operators :math:`\hat{\mathcal{H}}(n)` and :math:`\hat{\mathcal{I}}_{\alpha}^n`
act in the subspace :math:`n` of the Hilbert space, i. e. 
:math:`[\hat{\mathcal{I}}_{\alpha}^n, \hat{\mathcal{I}}_{\alpha}^{n^{\prime}}] = 0`,
:math:`[\hat{\mathcal{H}}(n), \hat{\mathcal{I}}_{\alpha}^{n^{\prime}}] = 0`
and
:math:`[\hat{\mathcal{H}}(n), \hat{\mathcal{H}}(n^{\prime})] = 0`
for :math:`n \ne n^{\prime}`.

Next we give specific examples which fill the above expression with life.


Zeeman energy
-------------

When an external magnetic field is applied the term of the form 


.. math::

    \hat{\mathcal{H}}_{Z-J}(n)
    =
    -
    \sum_{\alpha=1,2,3}
    g_n
    \mu_B
    \hat{J}^{n}_{\alpha}
    H_{\alpha}

where :math:`\hat{\mathbf{J}}^n` is a total angular momentum operator, is included.

Or the term of the form

.. math::

    \hat{\mathcal{H}}_{Z-LS}(n)
    =
    -
    \sum_{\alpha=1,2,3}
    \mu_B
    \Bigl(
        2 \hat{S}^n_{\alpha} + \hat{L}^n_{\alpha}
    \Bigr)
    H_{\alpha}

where :math:`\hat{\mathbf{S}}^n` and :math:`\hat{\mathbf{L}}^n` are the (inverse)
spin and orbital angular momentum operators of the ion :math:`n`, respectively.

Note that by "external magnetic field :math:`\mathbf{H}`" we refer to the
magnetic field in the sample, which is the applied field (e. g. generated by a
coil) diminished by the demagnetizing tensor :math:`\overline{n}_{\text{demag}}`
times the magnetisation :math:`\mathbf{M}` of the sample, i. e.
:math:`\mathbf{H} = \mathbf{H}_{\text{applied}} - \overline{n}_{\text{demag}} \mathbf{M}`,
e. g. for a spherical sample :math:`\overline{n}_{\text{demag}} = 1/3\,\overline{I}`,
where :math:`\overline{I}` is the identity matrix. The unit of :math:`\mathbf{H}`
is usually chosen to be Tesla, which actually refers to the quantity
:math:`\mu_0 \mathbf{H}` (in SI units).

Magnetic exchange
-----------------

Isotropic magnetic exchange interaction (e. g. Heisenberg exchange) is written as

.. math::

    \hat{\mathcal{H}}_{X-J}
    =
    -
    \dfrac{1}{2}
    \sum_{nn^{\prime}, \alpha\beta=1,2,3}
    \mathcal{J}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

where the operators are understood as
:math:`\hat{\mathcal{I}}_{1}  \leftrightarrow \hat{J}_x`,
:math:`\hat{\mathcal{I}}_{2}  \leftrightarrow \hat{J}_y`,
:math:`\hat{\mathcal{I}}_{3}  \leftrightarrow \hat{J}_z`.

Intermediate coupling
---------------------

For some rare earth ions and for transition metals or actinides it is necessary
to include more single-ion ion states with different L, S into the calculation.
Two-ion intermediate interaction can be written as 


.. math::

    \hat{\mathcal{H}}_{IC}
    =
    -
    \dfrac{1}{2}
    \sum_{nn^{\prime},\alpha\beta=1,\dots,6}
    \mathcal{J}_{\alpha\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

where the operators are understood as
:math:`\hat{\mathcal{I}}_{1}  \leftrightarrow \hat{S}_x`,
:math:`\hat{\mathcal{I}}_{2}  \leftrightarrow \hat{S}_y`,
:math:`\hat{\mathcal{I}}_{3}  \leftrightarrow \hat{S}_z`,
:math:`\hat{\mathcal{I}}_{4}  \leftrightarrow \hat{L}_x`,
:math:`\hat{\mathcal{I}}_{5}  \leftrightarrow \hat{L}_y`,
:math:`\hat{\mathcal{I}}_{6}  \leftrightarrow \hat{L}_z`.

Dzyaloshinskii-Moriya interaction
---------------------------------

DMI can be written in the form of the two-ion interaction as

.. math::

    \hat{\mathcal{H}}_{DMI}
    =
    -
    \dfrac{1}{2}
    \sum_{nn^{\prime},\alpha\beta=1,2,3}
    \mathcal{J}_{\alpha\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

where the operators are understood as
:math:`\hat{\mathcal{I}}_{1}  \leftrightarrow \hat{J}_x`,
:math:`\hat{\mathcal{I}}_{2}  \leftrightarrow \hat{J}_y`,
:math:`\hat{\mathcal{I}}_{3}  \leftrightarrow \hat{J}_z` and
:math:`\mathcal{J}_{\alpha\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})` is a
skew-symmetric matrix.

Classical dipole dipole interaction
-----------------------------------

Classical magnetic dipole-dipole interaction can be written in the form of the
two-ion interaction with the matrix parameter 

.. math::

    \hat{\mathcal{H}}_{CDD}
    =
    -
    \dfrac{1}{2}
    \sum_{n\ne n^{\prime},\alpha\beta=1,2,3}
    \mathcal{J}_{\alpha\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

where the operators are understood as
:math:`\hat{\mathcal{I}}_{1}  \leftrightarrow \hat{J}_x`,
:math:`\hat{\mathcal{I}}_{2}  \leftrightarrow \hat{J}_y`,
:math:`\hat{\mathcal{I}}_{3}  \leftrightarrow \hat{J}_z` and 

.. math::

    \mathcal{J}_{\alpha\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    =
    \dfrac{\mu_0\mu_B^2 g_n g_{n^{\prime}}}{2\pi}
    \Biggl(
        3\dfrac{(R_{n^{\prime}}^{\alpha} - R_{n}^{\alpha})(R_{n^{\prime}}^{\beta} - R_{n}^{\beta})}{|\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n}|^5}
        -
        \dfrac{\delta_{\alpha\beta}}{|\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n}|^3}
    \Biggr)

Crystal field
-------------

Single-ion crystal field is written with Stevens operators as

.. math::

    \hat{\mathcal{H}}_{CF1-S}(n)
    =
    \sum_{lm}
    B_l^m
    \hat{O}_{lm}(\mathbf{J}^n)

or with Wybourne operators :math:`\hat{T}_{lm}^n` and Wybourne parameters
:math:`L_l^m` as

.. math::

    \hat{\mathcal{H}}_{CF1-W}(n)
    =  
    \sum_{lm}
    L_l^m(n)
    \hat{T}_{lm}^{n}
    
where :math:`\hat{T}_{lm}^n` is an operator equivalents of real valued spherical
harmonic functions

.. math::
    \hat{T}_{l0}
    &=
    \sqrt{4\pi/(2l+1)}
    \sum_i
    Y_{l0}(\Omega_{i_n}),\\
    \hat{T}_{l,\pm|m|}
    &=
    \sqrt{4\pi/(2l+1)}
    \sum_i
    \sqrt{\pm 1}
    [Y_{l,-|m|}(\Omega_{i_n}) \pm (-1)^m Y_{l,|m|}(\Omega_{i_n})]

for the ion :math:`n`, where index :math:`i_n` runs over all electrons in the
open shell of an ion (d, f). Two-ion crystal field can be written with the
Stevens operators as

.. math::

    \hat{\mathcal{H}}_{CF2-S}
    =
    -\dfrac{1}{2}
    \sum_{nn^{\prime}}
    \sum_{ll^{\prime}}
    \sum_{mm^{\prime}}
    K_{ll^{\prime}}^{mm^{\prime}}(nn^{\prime})
    \hat{O}_{lm}(\mathbf{J}^n)
    \hat{O}_{l^{\prime}m^{\prime}}(\mathbf{J}^{n^{\prime}})

or with the Wybourne operators  as

.. math::

    \hat{\mathcal{H}}_{CF2-W}
    =
    -
    \dfrac{1}{2}
    \sum_{nn^{\prime}}
    \Biggl[
        \sum_{kk^{\prime}}
        \sum_{qq^{\prime}}
        \mathcal{K}_{kk^{\prime}}^{qq^{\prime}}(nn^{\prime})
        \hat{T}_{kq}^n
        \hat{T}_{k^{\prime}q^{\prime}}^{n^{\prime}}
    \Biggr]

where operators are defined as :math:`\hat{\mathcal{I}}_{\alpha}^n \leftrightarrow \hat{O}_{lm}(\mathbf{J}^n)`
or :math:`\hat{\mathcal{I}}_{\alpha}^n \leftrightarrow \hat{T}_{kq}^n` and 
index :math:`\alpha` runs over :math:`m` pairs of :math:`(l,m)` or :math:`(k,q)`
respectively. Interaction parameters are either
:math:`\mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n}) \leftrightarrow K_{ll^{\prime}}^{mm^{\prime}}(nn^{\prime})`
or
:math:`\mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n}) \leftrightarrow \mathcal{K}_{kk^{\prime}}^{qq^{\prime}}(nn^{\prime})`,
where index :math:`\beta` runs over :math:`m` pairs of :math:`(l^{\prime},m^{\prime})` or :math:`(k^{\prime},q^{\prime})`
respectively.


Exchange striction
------------------

.. math::

    \hat{\mathcal{H}}_{XS}
    =
    -
    \dfrac{1}{2}
    \sum_{\substack{nn^{\prime},\alpha\beta\alpha^{\prime}\gamma=1,2,3\\\beta^{\prime}=1-6}}
    \Biggl(
        \dfrac{\partial \mathcal{J}_{\alpha\beta}}{\partial \epsilon_{\beta^{\prime}}}
        +
        \dfrac{\partial \mathcal{J}_{\alpha\beta}}{\partial R_{nn^{\prime}}^{\alpha^{\prime}}}
        \dfrac{\partial \epsilon_{\alpha^{\prime}\gamma} R_{nn^{\prime}}^{\gamma}}{\partial \epsilon_{\beta^{\prime}}}
    \Biggr)
    \epsilon_{\beta^{\prime}}
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}


Phonons
-------

A three dimensional Einstein oscillator (for atom :math:`n`) in a solid can be
described by the following Hamiltonian

.. math::

    \hat{\mathcal{H}}_{P1}(n)
    =
    \dfrac{a_0^2\hat{\mathbf{w}}_n^2}{2m_n}
    -
    \dfrac{1}{2}
    \sum_{\alpha\beta=1,2,3}
    \hat{u}_{\alpha}^n
    K(nn)
    \hat{u}_{\beta}^n
    -
    \sum_{\alpha=1,2,3}
    F_{\alpha}(n)
    \hat{u}_{\alpha}^n

Here :math:`\hat{\mathbf{u}}` is the dimensionless displacement vector 
:math:`\hat{\mathbf{u}} = \hat{\mathbf{P}}_n / a_0 = \Delta \hat{\mathbf{r}}_n / a_0`,
with the Bohr radius :math:`a_0 = 0.5219` Angstrom), :math:`m_n` the mass of the atom
:math:`n`, :math:`\hat{\mathbf{w}}_n = d\hat{\mathbf{u}}_n/dt = \mathbf{p}_n / a_0`
the conjugate momentum to :math:`\hat{\mathbf{u}}_n` and :math:`\overline{K}(nn)`
the matrix describing the restoring force.

External force :math:`\mathbf{F}(n)` can correspond to the electric field
:math:`\mathbf{E}_{\text{el}}`, i. e. :math:`\mathbf{F}(n) = q_n \mathbf{E}_{\text{el}} a_0`,
where Bohr radius :math:`a_0` is included in order to yield
:math:`\mathbf{F}_{\text{el}}(n)` in units of meV.

Coupling such oscillators leads to the Hamiltonian

.. math::

    \hat{\mathcal{H}}_{P2}
    =
    -
    \dfrac{1}{2}
    \sum_{n\ne n^{\prime},\alpha\beta=1,2,3}
    \hat{u}_{\alpha}^n
    K_{\alpha\beta}(nn^{\prime})
    \hat{u}_{\beta}^{n^{\prime}}

where operators are defined as :math:`\hat{\mathcal{I}}_{\alpha}^n \leftrightarrow \hat{\mathbf{u}}^n_{\alpha}`
and interaction parameters are
:math:`\mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n}) \leftrightarrow K_{\alpha\beta}(nn^{\prime})`.



Single-ion electrostatic and spin-orbit interaction
---------------------------------------------------

.. math::
    \hat{\mathcal{H}}_{E-SO}(n)
    =
    \sum_{i_n=1}^{\nu_n}
    \Biggl[
        \dfrac{(p_{i_n})^2}{2m_e}
        -
        \dfrac{Z_n e^2}{4\pi \epsilon_0 |\mathbf{r}_{i_n} - \mathbf{R}_n|}
        +
        \zeta_n
        \mathbf{l}^{i_n}
        \cdot
        \mathbf{s}^{i_n}
    \Biggr]
    +
    \sum_{i_n > j_n=1}^{\nu_n}
    \dfrac{e^2}{4\pi \epsilon_0 |\mathbf{r}_{i_n} - \mathbf{r}_{j_n}|}


Here :math:`\nu_n,Z_n` and :math:`\mathbf{R}_n` denote the number of electrons,
the charge of the nucleus and the position of the ion number :math:`n`,
respectively, for each electron being :math:`p` the momentum, :math:`m_e`
the mass, :math:`e` the charge and :math:`\mathbf{r}` the location. Spin orbit
coupling is written in terms of the orbital momentum :math:`\mathbf{l}` and spin
:math:`\mathbf{s}` of the individual electrons. 

Magneto-elastic interaction
---------------------------

.. math::

    \hat{\mathcal{H}}_{ME1}(n)
    =
    -
    \sum_{\substack{\alpha=1,\dots,6,\\\gamma=1,2,3}}
    G^{\alpha\gamma}_{\text{mix}}(n)
    \epsilon_{\alpha}
    \hat{u}_n^{\gamma}
    -
    \sum_{\alpha=1,\dots,6, lm}
    G^{\alpha,l,m}_{\text{cfph}}(n)
    \epsilon_{\alpha}
    O_{lm}(\hat{\mathbf{J}}^n)

and 


.. math::

    \hat{\mathcal{H}}_{ME2}
    =
    -
    \sum_{\substack{n<n^{\prime},lm,\\\alpha=1,2,3}}
    \Gamma^{\alpha,l,m}(nn^{\prime})
    \hat{u}_n^{\alpha}
    O_{lm}(\hat{\mathbf{J}}^{n^{\prime}})

Elastic energy and external stress
----------------------------------

Classical elastic energy and external stress can be included as


.. math::

    \hat{H}
    =
    \dfrac{1}{2}
    \sum_{\alpha\gamma=1-6}
    c^{\alpha\gamma}
    \epsilon_{\alpha}
    \epsilon_{\gamma}
    -
    \sum_{\alpha=1,\dots,6}
    \sigma_{\alpha}
    \epsilon_{\alpha}


Convention
==========


================= ===
================= ===
Spin normalized   no
Multiple counting yes
================= ===
